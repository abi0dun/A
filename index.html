<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SVG filterUnits â€” objectBoundingBox vs userSpaceOnUse</title>
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; margin: 20px; background: #f8fafc; color: #111; }
  h1 { margin: 0 0 12px; }
  .card { background: #fff; padding: 14px; border-radius: 10px; box-shadow: 0 6px 16px rgba(0,0,0,.05); }
  svg { background: linear-gradient(180deg, #fff, #f9fbff); border: 1px dashed #d1d5db; border-radius: 6px; }
  .controls { margin-bottom: 12px; display: flex; flex-wrap: wrap; gap: 10px; }
  button { padding: 6px 10px; border-radius: 6px; border: 1px solid #ddd; background: #fff; cursor: pointer; }
  .grid { display: flex; gap: 16px; flex-wrap: wrap; }
  .note { font-size: 14px; color: #444; margin-top: 8px; }
</style>
</head>
<body>

<h1>Filter Units Demo</h1>
<p>This demo compares <code>filterUnits="objectBoundingBox"</code> and <code>filterUnits="userSpaceOnUse"</code>.</p>

<div class="card">
  <div class="controls">
    <button id="toggleUnits">Toggle Units (Left)</button>
    <button id="resizeSmall">Small Shapes</button>
    <button id="resizeWide">Wide Shapes</button>
  </div>

  <div class="grid">
    <!-- Left: objectBoundingBox -->
    <div>
      <p><strong>Left:</strong> <code>filterUnits="objectBoundingBox"</code></p>
      <svg id="svgObj" width="300" height="120" viewBox="0 0 300 120">
        <defs>
          <filter id="blurObj" filterUnits="objectBoundingBox">
            <feGaussianBlur stdDeviation="0.05" />
          </filter>
        </defs>

        <rect id="objRect1" x="20" y="10" width="120" height="100" fill="#6366f1" filter="url(#blurObj)" />
        <rect id="objRect2" x="160" y="10" width="80" height="50" fill="#f97316" filter="url(#blurObj)" />
      </svg>
    </div>

    <!-- Right: userSpaceOnUse -->
    <div>
      <p><strong>Right:</strong> <code>filterUnits="userSpaceOnUse"</code></p>
      <svg id="svgUsr" width="300" height="120" viewBox="0 0 300 120">
        <defs>
          <filter id="blurUsr" filterUnits="userSpaceOnUse" x="0" y="0" width="300" height="120">
            <feGaussianBlur stdDeviation="5" />
          </filter>
        </defs>

        <rect id="usrRect1" x="20" y="10" width="120" height="100" fill="#6366f1" filter="url(#blurUsr)" />
        <rect id="usrRect2" x="160" y="10" width="80" height="50" fill="#f97316" filter="url(#blurUsr)" />
      </svg>
    </div>
  </div>

  <p class="note">
    ðŸ”¸ <b>objectBoundingBox</b>: blur area and radius scale relative to each shapeâ€™s size.<br>
    ðŸ”¹ <b>userSpaceOnUse</b>: blur area is fixed in SVG coordinate space â€” all shapes share the same filter region.
  </p>
</div>

<script>
  // change rectangle sizes
  function setSize(mode) {
    const r1 = document.getElementById('objRect1');
    const r2 = document.getElementById('objRect2');
    const u1 = document.getElementById('usrRect1');
    const u2 = document.getElementById('usrRect2');

    if (mode === 'small') {
      [r1,u1].forEach(r=>{r.setAttribute('width',120);r.setAttribute('height',100);});
      [r2,u2].forEach(r=>{r.setAttribute('width',80);r.setAttribute('height',50);r.setAttribute('x',160);r.setAttribute('y',10);});
    } else {
      [r1,u1].forEach(r=>{r.setAttribute('width',200);r.setAttribute('height',60);});
      [r2,u2].forEach(r=>{r.setAttribute('width',140);r.setAttribute('height',40);r.setAttribute('x',150);r.setAttribute('y',30);});
    }
  }

  document.getElementById('resizeSmall').addEventListener('click', ()=>setSize('small'));
  document.getElementById('resizeWide').addEventListener('click', ()=>setSize('wide'));

  // toggle filter units on left SVG
  document.getElementById('toggleUnits').addEventListener('click', ()=>{
    const filter = document.getElementById('blurObj');
    const fe = filter.querySelector('feGaussianBlur');
    const current = filter.getAttribute('filterUnits');
    if (current === 'objectBoundingBox') {
      filter.setAttribute('filterUnits','userSpaceOnUse');
      filter.setAttribute('x','0');
      filter.setAttribute('y','0');
      filter.setAttribute('width','300');
      filter.setAttribute('height','120');
      fe.setAttribute('stdDeviation','5');
      alert('Left filter now uses userSpaceOnUse (absolute SVG coordinates)');
    } else {
      filter.setAttribute('filterUnits','objectBoundingBox');
      filter.removeAttribute('x');
      filter.removeAttribute('y');
      filter.removeAttribute('width');
      filter.removeAttribute('height');
      fe.setAttribute('stdDeviation','0.05');
      alert('Left filter now uses objectBoundingBox (relative to each elementâ€™s box)');
    }
  });

  setSize('small');
</script>

</body>
</html>