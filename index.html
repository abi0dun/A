<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SVG: objectBoundingBox vs userSpaceOnUse — Interactive Demo</title>
<style>
  :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;line-height:1.35}
  body{margin:20px;background:#f6f8fb;color:#111}
  h1{margin:0 0 12px}
  .hint{color:#444;margin-bottom:18px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:18px}
  .card{background:#fff;border-radius:10px;padding:14px;box-shadow:0 6px 18px rgba(20,30,60,.06)}
  .controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px;align-items:center}
  .controls button, .controls select{padding:6px 10px;border-radius:6px;border:1px solid #ddd;background:#fff;cursor:pointer}
  .svgwrap{display:flex;gap:10px;align-items:center;justify-content:space-around;flex-wrap:wrap}
  svg{background:linear-gradient(180deg,#fff,#fbfdff);border:1px dashed #e2e8f0;border-radius:6px}
  .label{font-size:13px;color:#333;margin-bottom:6px}
  .small{font-size:13px;color:#666}
  footer{margin-top:18px;color:#666;font-size:13px}
  .row{display:flex;gap:6px;flex-wrap:wrap;align-items:center}
  .note{font-size:13px;color:#555;margin-top:8px}
</style>
</head>
<body>

<h1>SVG units demo — <small style="font-weight:400">objectBoundingBox vs userSpaceOnUse</small></h1>
<p class="hint">Each card shows two examples side-by-side: left uses <code>objectBoundingBox</code> (relative 0→1) and right uses <code>userSpaceOnUse</code> (absolute SVG coords). Use controls to toggle and resize shapes.</p>

<div class="grid">

  <!-- GRADIENT -->
  <div class="card" id="card-gradient">
    <div class="label">Gradient — linearGradient (gradientUnits)</div>
    <div class="controls">
      <div class="row">
        <button id="gradToggle">Toggle units (objectBoundingBox ↔ userSpaceOnUse)</button>
        <button id="gradSizeSmall">Small / Square</button>
        <button id="gradSizeWide">Wide / Short</button>
      </div>
      <div class="small">Left: <code>gradientUnits="objectBoundingBox"</code>. Right: <code>gradientUnits="userSpaceOnUse"</code>.</div>
    </div>

    <div class="svgwrap">
      <!-- left: objectBoundingBox -->
      <svg id="grad_svg_obj" width="300" height="120" viewBox="0 0 300 120">
        <defs>
          <linearGradient id="g_obj" gradientUnits="objectBoundingBox">
            <stop offset="0%" stop-color="#ff6b6b"/>
            <stop offset="100%" stop-color="#4f46e5"/>
          </linearGradient>
        </defs>
        <!-- two rects: big and small. We'll change widths with JS -->
        <rect id="g_obj_rect1" x="20" y="10" width="120" height="100" fill="url(#g_obj)"/>
        <rect id="g_obj_rect2" x="160" y="10" width="80" height="50" fill="url(#g_obj)"/>
      </svg>

      <!-- right: userSpaceOnUse -->
      <svg id="grad_svg_usr" width="300" height="120" viewBox="0 0 300 120">
        <defs>
          <!-- fixed gradient across the SVG left->right -->
          <linearGradient id="g_usr" gradientUnits="userSpaceOnUse" x1="0" y1="0" x2="300" y2="0">
            <stop offset="0%" stop-color="#ff6b6b"/>
            <stop offset="100%" stop-color="#4f46e5"/>
          </linearGradient>
        </defs>
        <rect id="g_usr_rect1" x="20" y="10" width="120" height="100" fill="url(#g_usr)"/>
        <rect id="g_usr_rect2" x="160" y="10" width="80" height="50" fill="url(#g_usr)"/>
      </svg>
    </div>
    <div class="note">Try the buttons — with <code>objectBoundingBox</code> the gradient adapts inside each rect. With <code>userSpaceOnUse</code> the gradient is fixed to the SVG coordinates.</div>
  </div>

  <!-- CLIPPATH -->
  <div class="card">
    <div class="label">clipPath — (clipPathUnits)</div>
    <div class="controls">
      <div class="row">
        <button id="clipToggle">Toggle units</button>
        <button id="clipSizeSmall">Small / Square</button>
        <button id="clipSizeWide">Wide / Short</button>
      </div>
      <div class="small">Left: <code>clipPathUnits="objectBoundingBox"</code>. Right: <code>clipPathUnits="userSpaceOnUse"</code>.</div>
    </div>

    <div class="svgwrap">
      <!-- left: objectBoundingBox -->
      <svg id="clip_svg_obj" width="300" height="120" viewBox="0 0 300 120">
        <defs>
          <clipPath id="c_obj" clipPathUnits="objectBoundingBox">
            <!-- circle defined relative to the element's box using 0..1 coordinates -->
            <circle cx="0.5" cy="0.5" r="0.5" />
          </clipPath>
        </defs>

        <rect id="c_obj_rect1" x="20" y="10" width="120" height="100" fill="#f97316" clip-path="url(#c_obj)"/>
        <rect id="c_obj_rect2" x="160" y="10" width="80" height="50" fill="#10b981" clip-path="url(#c_obj)"/>
      </svg>

      <!-- right: userSpaceOnUse -->
      <svg id="clip_svg_usr" width="300" height="120" viewBox="0 0 300 120">
        <defs>
          <clipPath id="c_usr" clipPathUnits="userSpaceOnUse">
            <!-- fixed circle in svg coords -->
            <circle cx="100" cy="60" r="45" />
          </clipPath>
        </defs>

        <rect id="c_usr_rect1" x="20" y="10" width="120" height="100" fill="#f97316" clip-path="url(#c_usr)"/>
        <rect id="c_usr_rect2" x="160" y="10" width="80" height="50" fill="#10b981" clip-path="url(#c_usr)"/>
      </svg>
    </div>
    <div class="note">With <code>objectBoundingBox</code> the circle is centered and scaled inside each shape; with <code>userSpaceOnUse</code> both shapes are clipped by the single fixed circle in SVG coordinates.</div>
  </div>

  <!-- FILTER -->
  <div class="card">
    <div class="label">Filter — (filterUnits)</div>
    <div class="controls">
      <div class="row">
        <button id="filterToggle">Toggle units</button>
        <button id="filterSizeSmall">Small / Square</button>
        <button id="filterSizeWide">Wide / Short</button>
      </div>
      <div class="small">Left: <code>filterUnits="objectBoundingBox"</code>. Right: <code>filterUnits="userSpaceOnUse"</code>.</div>
    </div>

    <div class="svgwrap">
      <!-- left: objectBoundingBox -->
      <svg id="f_svg_obj" width="300" height="120" viewBox="0 0 300 120">
        <defs>
          <filter id="f_obj" filterUnits="objectBoundingBox">
            <!-- for objectBoundingBox, stdDeviation is relative — small numbers map to relative blur -->
            <feGaussianBlur in="SourceGraphic" stdDeviation="0.03"/>
          </filter>
        </defs>

        <rect id="f_obj_rect1" x="20" y="10" width="120" height="100" fill="#6d28d9" filter="url(#f_obj)"/>
        <rect id="f_obj_rect2" x="160" y="10" width="80" height="50" fill="#059669" filter="url(#f_obj)"/>
      </svg>

      <!-- right: userSpaceOnUse -->
      <svg id="f_svg_usr" width="300" height="120" viewBox="0 0 300 120">
        <defs>
          <filter id="f_usr" filterUnits="userSpaceOnUse" x="0" y="0" width="300" height="120">
            <!-- in px: larger stdDeviation -->
            <feGaussianBlur in="SourceGraphic" stdDeviation="6"/>
          </filter>
        </defs>

        <rect id="f_usr_rect1" x="20" y="10" width="120" height="100" fill="#6d28d9" filter="url(#f_usr)"/>
        <rect id="f_usr_rect2" x="160" y="10" width="80" height="50" fill="#059669" filter="url(#f_usr)"/>
      </svg>
    </div>
    <div class="note">Filters measured relative to the object will scale; filters in user space stay constant in pixel size.</div>
  </div>

  <!-- PATTERN -->
  <div class="card">
    <div class="label">Pattern — (patternUnits)</div>
    <div class="controls">
      <div class="row">
        <button id="patToggle">Toggle units</button>
        <button id="patSizeSmall">Small / Square</button>
        <button id="patSizeWide">Wide / Short</button>
      </div>
      <div class="small">Left: <code>patternUnits="objectBoundingBox"</code>. Right: <code>patternUnits="userSpaceOnUse"</code>.</div>
    </div>

    <div class="svgwrap">
      <!-- left: objectBoundingBox -->
      <svg id="p_svg_obj" width="300" height="120" viewBox="0 0 300 120">
        <defs>
          <pattern id="p_obj" patternUnits="objectBoundingBox" width="0.2" height="0.2">
            <!-- coordinates here are 0..1 relative to each object's box -->
            <circle cx="0.1" cy="0.1" r="0.08" fill="#ef4444"/>
          </pattern>
        </defs>

        <rect id="p_obj_rect1" x="20" y="10" width="120" height="100" fill="url(#p_obj)"/>
        <rect id="p_obj_rect2" x="160" y="10" width="80" height="50" fill="url(#p_obj)"/>
      </svg>

      <!-- right: userSpaceOnUse -->
      <svg id="p_svg_usr" width="300" height="120" viewBox="0 0 300 120">
        <defs>
          <pattern id="p_usr" patternUnits="userSpaceOnUse" width="30" height="30">
            <circle cx="15" cy="15" r="10" fill="#ef4444"/>
          </pattern>
        </defs>

        <rect id="p_usr_rect1" x="20" y="10" width="120" height="100" fill="url(#p_usr)"/>
        <rect id="p_usr_rect2" x="160" y="10" width="80" height="50" fill="url(#p_usr)"/>
      </svg>
    </div>
    <div class="note">Patterns with objectBoundingBox tile relative to each object; with userSpaceOnUse the tile is fixed in pixel-space and reused across shapes.</div>
  </div>

</div>

<footer>
  Tip: open DevTools and inspect the SVG elements to watch attributes change. Save the file and refresh after edits.
</footer>

<script>
  // Utility to set sizes for a given prefix
  function setSize(prefix, mode) {
    // mode: "small" => rect1 120x100, rect2 80x50
    // mode: "wide" => rect1 200x60, rect2 140x40
    const rect1 = document.getElementById(prefix + '_rect1');
    const rect2 = document.getElementById(prefix + '_rect2');
    if (!rect1 || !rect2) return;
    if (mode === 'small') {
      rect1.setAttribute('width', 120);
      rect1.setAttribute('height', 100);
      rect2.setAttribute('width', 80);
      rect2.setAttribute('height', 50);
      // reposition rect2 for nicer layout
      rect2.setAttribute('x', 160);
      rect2.setAttribute('y', 10);
    } else {
      rect1.setAttribute('width', 200);
      rect1.setAttribute('height', 60);
      rect2.setAttribute('width', 140);
      rect2.setAttribute('height', 40);
      rect2.setAttribute('x', 150);
      rect2.setAttribute('y', 30);
    }
  }

  // GRADIENT toggle example: replace gradientUnits between objectBoundingBox and userSpaceOnUse
  document.getElementById('gradToggle').addEventListener('click', () => {
    const gObj = document.getElementById('g_obj');
    const gUsr = document.getElementById('g_usr');

    // toggle the left gradient between objectBoundingBox/userSpaceOnUse
    const left = gObj.getAttribute('gradientUnits') === 'objectBoundingBox' ? 'userSpaceOnUse' : 'objectBoundingBox';
    gObj.setAttribute('gradientUnits', left);
    alert('Left gradientUnits is now: ' + left + '\n(Compare behavior vs the right SVG which is userSpaceOnUse fixed.)');
  });

  document.getElementById('gradSizeSmall').addEventListener('click', () => setSize('g_obj', 'small') || setSize('g_usr', 'small'));
  document.getElementById('gradSizeWide').addEventListener('click', () => setSize('g_obj', 'wide') || setSize('g_usr', 'wide'));

  // CLIPPATH toggle: toggle left clipPathUnits
  document.getElementById('clipToggle').addEventListener('click', () => {
    const c = document.getElementById('c_obj');
    const newVal = c.getAttribute('clipPathUnits') === 'objectBoundingBox' ? 'userSpaceOnUse' : 'objectBoundingBox';
    c.setAttribute('clipPathUnits', newVal);
    // if switched to userSpaceOnUse we must ensure the inner shape has sensible coords, so switch circle attributes:
    if (newVal === 'userSpaceOnUse') {
      // switch the circle inside to SVG coords
      const circle = c.querySelector('circle');
      circle.setAttribute('cx', 100);
      circle.setAttribute('cy', 60);
      circle.setAttribute('r', 45);
    } else {
      const circle = c.querySelector('circle');
      circle.setAttribute('cx', 0.5);
      circle.setAttribute('cy', 0.5);
      circle.setAttribute('r', 0.5);
    }
    alert('Left clipPathUnits now: ' + newVal);
  });

  document.getElementById('clipSizeSmall').addEventListener('click', () => setSize('c_obj', 'small') || setSize('c_usr', 'small'));
  document.getElementById('clipSizeWide').addEventListener('click', () => setSize('c_obj', 'wide') || setSize('c_usr', 'wide'));

  // FILTER toggle
  document.getElementById('filterToggle').addEventListener('click', () => {
    const f = document.getElementById('f_obj');
    const newVal = f.getAttribute('filterUnits') === 'objectBoundingBox' ? 'userSpaceOnUse' : 'objectBoundingBox';
    f.setAttribute('filterUnits', newVal);

    if (newVal === 'userSpaceOnUse') {
      // set a px blur for user space; adjust filter region
      f.setAttribute('x','0');
      f.setAttribute('y','0');
      f.setAttribute('width','300');
      f.setAttribute('height','120');
      const blur = f.querySelector('feGaussianBlur');
      blur.setAttribute('stdDeviation','6');
    } else {
      // relative
      f.removeAttribute('x');
      f.removeAttribute('y');
      f.removeAttribute('width');
      f.removeAttribute('height');
      const blur = f.querySelector('feGaussianBlur');
      blur.setAttribute('stdDeviation','0.03');
    }
    alert('Left filterUnits now: ' + newVal);
  });

  document.getElementById('filterSizeSmall').addEventListener('click', () => setSize('f_obj', 'small') || setSize('f_usr', 'small'));
  document.getElementById('filterSizeWide').addEventListener('click', () => setSize('f_obj', 'wide') || setSize('f_usr', 'wide'));

  // PATTERN toggle
  document.getElementById('patToggle').addEventListener('click', () => {
    const p = document.getElementById('p_obj');
    const newVal = p.getAttribute('patternUnits') === 'objectBoundingBox' ? 'userSpaceOnUse' : 'objectBoundingBox';
    p.setAttribute('patternUnits', newVal);
    if (newVal === 'userSpaceOnUse') {
      p.setAttribute('width', '30');
      p.setAttribute('height', '30');
      const c = p.querySelector('circle');
      c.setAttribute('cx','15'); c.setAttribute('cy','15'); c.setAttribute('r','10');
    } else {
      p.setAttribute('width','0.2');
      p.setAttribute('height','0.2');
      const c = p.querySelector('circle');
      c.setAttribute('cx','0.1'); c.setAttribute('cy','0.1'); c.setAttribute('r','0.08');
    }
    alert('Left patternUnits now: ' + newVal);
  });

  document.getElementById('patSizeSmall').addEventListener('click', () => setSize('p_obj', 'small') || setSize('p_usr', 'small'));
  document.getElementById('patSizeWide').addEventListener('click', () => setSize('p_obj', 'wide') || setSize('p_usr', 'wide'));

  // Initialize sizes (ensure consistent starting sizes)
  ['g','c','f','p'].forEach(prefix => setSize(prefix + (prefix==='g' ? '_obj' : '_obj'), 'small'));

  // Minor helper: close alerts replaced with in-page messages could be nicer; kept alert for clarity that toggle happened.
</script>
</body>
</html>
